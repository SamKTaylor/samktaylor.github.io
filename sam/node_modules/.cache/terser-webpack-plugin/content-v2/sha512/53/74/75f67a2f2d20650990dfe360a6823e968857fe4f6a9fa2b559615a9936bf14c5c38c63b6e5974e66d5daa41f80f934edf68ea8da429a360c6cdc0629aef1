{"code":"!function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,\"a\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\"\",r(r.s=0)}([function(t,e,r){\"use strict\";r.r(e);var i=function(t,e){var r,i,n,o,h={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},\"function\"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError(\"Generator is already executing.\");for(;h;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return h.label++,{value:o[1],done:!1};case 5:h.label++,i=o[1],o=[0];continue;case 7:o=h.ops.pop(),h.trys.pop();continue;default:if(!(n=h.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){h=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){h.label=o[1];break}if(6===o[0]&&h.label<n[1]){h.label=n[1],n=o;break}if(n&&h.label<n[2]){h.label=n[2],h.ops.push(o);break}n[2]&&h.ops.pop(),h.trys.pop();continue}o=e.call(t,h)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};!function(){function t(e){var r=this;void 0===e&&(e=t.minComparator),this.compare=e,this.heapArray=[],this._limit=0,this.offer=this.add,this.element=this.peek,this.poll=this.pop,this._invertedCompare=function(t,e){return-1*r.compare(t,e)}}t.getChildrenIndexOf=function(t){return[2*t+1,2*t+2]},t.getParentIndexOf=function(t){if(t<=0)return-1;var e=t%2?1:2;return Math.floor((t-e)/2)},t.getSiblingIndexOf=function(t){return t<=0?-1:t+(t%2?1:-1)},t.minComparator=function(t,e){return t>e?1:t<e?-1:0},t.maxComparator=function(t,e){return e>t?1:e<t?-1:0},t.minComparatorNumber=function(t,e){return t-e},t.maxComparatorNumber=function(t,e){return e-t},t.defaultIsEqual=function(t,e){return t===e},t.print=function(e){function r(e){var r=t.getParentIndexOf(e);return Math.floor(Math.log2(r+1))}function i(t,e){for(var r=\"\";e>0;--e)r+=t;return r}for(var n=0,o=[],h=r(e.length-1)+2,a=0;n<e.length;){var s=r(n)+1;0===n&&(s=0);var p=String(e.get(n));p.length>a&&(a=p.length),o[s]=o[s]||[],o[s].push(p),n+=1}return o.map((function(t,e){var r=Math.pow(2,h-e)-1;return i(\" \",Math.floor(r/2)*a)+t.map((function(t){var e=(a-t.length)/2;return i(\" \",Math.ceil(e))+t+i(\" \",Math.floor(e))})).join(i(\" \",r*a))})).join(\"\\n\")},t.heapify=function(e,r){var i=new t(r);return i.heapArray=e,i.init(),i},t.heappop=function(e,r){var i=new t(r);return i.heapArray=e,i.pop()},t.heappush=function(e,r,i){var n=new t(i);n.heapArray=e,n.push(r)},t.heappushpop=function(e,r,i){var n=new t(i);return n.heapArray=e,n.pushpop(r)},t.heapreplace=function(e,r,i){var n=new t(i);return n.heapArray=e,n.replace(r)},t.heaptop=function(e,r,i){void 0===r&&(r=1);var n=new t(i);return n.heapArray=e,n.top(r)},t.heapbottom=function(e,r,i){void 0===r&&(r=1);var n=new t(i);return n.heapArray=e,n.bottom(r)},t.prototype.add=function(t){return this._sortNodeUp(this.heapArray.push(t)-1),this._applyLimit(),!0},t.prototype.addAll=function(t){var e,r=this.length;(e=this.heapArray).push.apply(e,t);for(var i=this.length;r<i;++r)this._sortNodeUp(r);return this._applyLimit(),!0},t.prototype.bottom=function(t){return void 0===t&&(t=1),0===this.heapArray.length||t<=0?[]:1===this.heapArray.length?[this.heapArray[0]]:t>=this.heapArray.length?this.heapArray.slice(0):this._bottomN_push(t)},t.prototype.check=function(){var t=this;return this.heapArray.find((function(e,r,i){return!!t.getChildrenOf(r).find((function(r){return t.compare(e,r)>0}))}))},t.prototype.clear=function(){this.heapArray=[]},t.prototype.clone=function(){var e=new t(this.comparator());return e.heapArray=this.toArray(),e._limit=this._limit,e},t.prototype.comparator=function(){return this.compare},t.prototype.contains=function(e,r){return void 0===r&&(r=t.defaultIsEqual),this.heapArray.findIndex((function(t){return r(t,e)}))>=0},t.prototype.init=function(t){t&&(this.heapArray=t.slice(0));for(var e=Math.floor(this.heapArray.length);e>=0;--e)this._sortNodeDown(e);this._applyLimit()},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.leafs=function(){if(0===this.heapArray.length)return[];var e=t.getParentIndexOf(this.heapArray.length-1);return this.heapArray.slice(e+1)},Object.defineProperty(t.prototype,\"length\",{get:function(){return this.heapArray.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"limit\",{get:function(){return this._limit},set:function(t){this._limit=t,this._applyLimit()},enumerable:!0,configurable:!0}),t.prototype.peek=function(){return this.heapArray[0]},t.prototype.pop=function(){var t=this.heapArray.pop();return this.length>0&&void 0!==t?this.replace(t):t},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!(t.length<1)&&(1===t.length?this.add(t[0]):this.addAll(t))},t.prototype.pushpop=function(t){var e;return this.compare(this.heapArray[0],t)<0&&(t=(e=[this.heapArray[0],t])[0],this.heapArray[0]=e[1],this._sortNodeDown(0)),t},t.prototype.remove=function(e,r){if(void 0===r&&(r=t.defaultIsEqual),this.length>0){if(void 0===e)return this.pop(),!0;var i=this.heapArray.findIndex((function(t){return r(t,e)}));if(i>=0)return 0===i?this.pop():i===this.length-1?this.heapArray.pop():(this.heapArray.splice(i,1,this.heapArray.pop()),this._sortNodeUp(i),this._sortNodeDown(i)),!0}return!1},t.prototype.replace=function(t){var e=this.heapArray[0];return this.heapArray[0]=t,this._sortNodeDown(0),e},t.prototype.size=function(){return this.length},t.prototype.top=function(t){return void 0===t&&(t=1),0===this.heapArray.length||t<=0?[]:1===this.heapArray.length||1===t?[this.heapArray[0]]:t>=this.heapArray.length?this.heapArray.slice(0):this._topN_push(t)},t.prototype.toArray=function(){return this.heapArray.slice(0)},t.prototype.toString=function(){return this.heapArray.toString()},t.prototype.get=function(t){return this.heapArray[t]},t.prototype.getChildrenOf=function(e){var r=this;return t.getChildrenIndexOf(e).map((function(t){return r.heapArray[t]})).filter((function(t){return void 0!==t}))},t.prototype.getParentOf=function(e){var r=t.getParentIndexOf(e);return this.heapArray[r]},t.prototype[Symbol.iterator]=function(){return i(this,(function(t){switch(t.label){case 0:return this.length?[4,this.pop()]:[3,2];case 1:return t.sent(),[3,0];case 2:return[2]}}))},t.prototype.iterator=function(){return this},t.prototype._applyLimit=function(){if(this._limit&&this._limit<this.heapArray.length)for(var t=this.heapArray.length-this._limit;t;)this.heapArray.pop(),--t},t.prototype._bottomN_push=function(e){var r=new t(this.compare);r.limit=e,r.init(this.heapArray.slice(-e));for(var i=this.heapArray.length-1-e,n=t.getParentIndexOf(i),o=[],h=i;h>n;--h)o.push(h);for(var a=this.heapArray;o.length;){h=o.shift();this.compare(a[h],r.peek())>0&&(r.replace(a[h]),h%2&&o.push(t.getParentIndexOf(h)))}return r.toArray()},t.prototype._moveNode=function(t,e){var r;r=[this.heapArray[e],this.heapArray[t]],this.heapArray[t]=r[0],this.heapArray[e]=r[1]},t.prototype._sortNodeDown=function(e){for(var r=this,i=e<this.heapArray.length-1,n=this.heapArray[e],o=function(t,e){return r.heapArray.length>e&&r.compare(r.heapArray[e],r.heapArray[t])<0&&(t=e),t};i;){var h=t.getChildrenIndexOf(e),a=h.reduce(o,h[0]),s=this.heapArray[a];void 0!==s&&this.compare(n,s)>0?(this._moveNode(e,a),e=a):i=!1}},t.prototype._sortNodeUp=function(e){for(var r=e>0;r;){var i=t.getParentIndexOf(e);i>=0&&this.compare(this.heapArray[i],this.heapArray[e])>0?(this._moveNode(e,i),e=i):r=!1}},t.prototype._topN_push=function(e){var r=new t(this._invertedCompare);r.limit=e;for(var i=[0],n=this.heapArray;i.length;){var o=i.shift();o<n.length&&(r.length<e?(r.push(n[o]),i.push.apply(i,t.getChildrenIndexOf(o))):this.compare(n[o],r.peek())<0&&(r.replace(n[o]),i.push.apply(i,t.getChildrenIndexOf(o))))}return r.toArray()},t.prototype._topN_fill=function(e){var r=this.heapArray,i=new t(this._invertedCompare);i.limit=e,i.init(r.slice(0,e));for(var n=[],o=t.getParentIndexOf(e-1)+1;o<e;++o)n.push.apply(n,t.getChildrenIndexOf(o).filter((function(t){return t<r.length})));for((e-1)%2&&n.push(e);n.length;){(o=n.shift())<r.length&&this.compare(r[o],i.peek())<0&&(i.replace(r[o]),n.push.apply(n,t.getChildrenIndexOf(o)))}return i.toArray()},t.prototype._topN_heap=function(t){for(var e=this.clone(),r=[],i=0;i<t;++i)r.push(e.pop());return r},t.prototype._topIdxOf=function(t){if(!t.length)return-1;for(var e=0,r=t[e],i=1;i<t.length;++i){this.compare(t[i],r)<0&&(e=i,r=t[i])}return e},t.prototype._topOf=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=new t(this.compare);return i.init(e),i.peek()}}();class n{constructor(t,e,r,i){this.x1=t,this.y1=e,this.x2=r,this.y2=i}width(){return this.x2-this.x1}height(){return this.y2-this.y1}contains(t,e){return this.x1<t&&t<this.x2&&this.y1<e&&e<this.y2}intersects(t){return this.x1<=t.x2&&t.x1<=this.x2&&this.y1<=t.y2&&t.y1<=this.y2}intersects_segment(t,e,r,i){let n=(this.x1-t)*r,o=(this.x2-t)*r,h=(this.y1-e)*i,a=(this.y2-e)*i,s=Math.max(Math.min(n,o),Math.min(h,a)),p=Math.min(Math.max(n,o),Math.max(h,a));return!(p<0)&&!(p>1||s>p)}static square(t,e,r){let i=r/2;return new n(t-i,e-i,t+i,e+i)}}class o{constructor(t,e,r,i){this.level=i||Math.ceil(Math.log2(t.width()/10)),this.root=r||this,this.region=t,this.x=(t.x1+t.x2)/2,this.y=(t.y1+t.y2)/2,this.obstacles=e,this.crossable=!0,this.is_leaf=!1,0==this.obstacles.length?this.is_leaf=!0:0==this.level&&(this.is_leaf=!0,this.crossable=!1),this.quads=null,this.neighbors=null,this.list_id=0,this.heuristic=0,this.is_leaf||this.subdivide()}get_quad(t,e){return t<this.x&&e<this.y?this.quads[0]:t>=this.x&&e<this.y?this.quads[1]:t<this.x&&e>=this.y?this.quads[2]:this.quads[3]}subdivide(){this.quads=[];let t=this.region.x1,e=this.region.x2,r=this.region.y1,i=this.region.y2,h=this.x,a=this.y,s=[new n(t,r,h,a),new n(h,r,e,a),new n(t,a,h,i),new n(h,a,e,i)],p=this.obstacles;for(let t=0;t<s.length;t++){let e=s[t],r=[];for(let t=0;t<p.length;t++){let i=p[t];e.intersects(i)&&r.push(i)}this.quads[t]=new o(e,r,this.root,this.level-1)}}get(t,e){return this.region.contains(t,e)?this.is_leaf?this:this.get_quad(t,e).get(t,e):null}get_neighbors(){if(!this.is_leaf)throw new Error(\"Tried getting neighbors of non-leaf node\");if(this.neighbors)return this.neighbors;let t=this.region.x1,e=this.region.x2,r=this.region.y1,i=this.region.y2,n=this.region.width()*2**-this.level,o=2**this.level,h=new Set;for(let t=-(o+1);t<=o+1;t+=2){let e=this.x+n*(t/2),o=this.root.get(e,r-n/2);o&&o.crossable&&h.add(o),o=this.root.get(e,i+n/2),o&&o.crossable&&h.add(o)}for(let r=-(o-1);r<=o-1;r+=2){let i=this.y+n*(r/2),o=this.root.get(t-n/2,i);o&&o.crossable&&h.add(o),o=this.root.get(e+n/2,i),o&&o.crossable&&h.add(o)}return this.neighbors=[...h],this.neighbors}get_containing(t,e){if(this.is_leaf)return this;let r=this.get_quad(t.x,t.y);return r==this.get_quad(e.x,e.y)?r.get_containing(t,e):this}has_sight(t){let e=this.root.get_containing(this,t).obstacles,r=Math.min(t.x,this.x),i=Math.max(t.x,this.x),n=Math.min(t.y,this.y),o=Math.max(t.y,this.y),h=1/(t.x-this.x),a=1/(t.y-this.y);for(let t=0;t<e.length;t++){let s=e[t];if(i>=s.x1&&r<=s.x2&&o>=s.y1&&n<=s.y2&&s.intersects_segment(this.x,this.y,h,a))return!1}return!0}}!function(t){let e=parent.G.maps[t].data,r=1/0,i=-1/0,h=1/0,a=-1/0,s=[];for(let t of e.x_lines)r=Math.min(r,t[0]),i=Math.max(i,t[0]),s.push(new n(t[0]-3,t[1]-3,t[0]+3,t[2]+7));for(let t of e.y_lines)h=Math.min(h,t[0]),a=Math.max(a,t[0]),s.push(new n(t[1]-3,t[0]-3,t[2]+3,t[0]+7));let p=function(t){let e=10;for(;e<t;)e*=2;return e}(Math.max(i-r,a-h)),u=(i+r)/2,l=(a+h)/2,f=n.square(u,l,p);new o(f,s)}(\"main\")}]);","extractedComments":[]}